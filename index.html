
<!DOCTYPE html>
<html lang="es" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RentHub 2030 - La plataforma de alquiler más confiable</title>
    
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://www.gstatic.com https://cdnjs.cloudflare.com 'unsafe-inline'; style-src 'self' https://cdnjs.cloudflare.com 'unsafe-inline'; img-src 'self' https: data:; connect-src 'self' https://*.firebaseapp.com https://*.googleapis.com; font-src 'self' https://cdnjs.cloudflare.com;">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #5E35B1;
            --secondary: #6A5ACD;
            --success: #2ecc71;
            --light: #F5F5F5;
            --dark: #1A1A1A;
            --gray: #6C757D;
            --accent: #FF8A65;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            line-height: 1.6;
            color: var(--dark);
            background-color: white;
        }
        header {
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.08);
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
        }
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 5%;
            max-width: 1400px;
            margin: 0 auto;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--dark);
            text-decoration: none;
        }
        .logo i {
            font-size: 1.8rem;
            color: var(--primary);
        }
        .nav-links {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
        }
        .nav-links a:hover {
            color: var(--primary);
        }
        .nav-buttons {
            display: flex;
            gap: 1rem;
        }
        .btn {
            padding: 0.6rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }
        .btn-outline {
            border: 2px solid var(--primary);
            color: var(--primary);
            background: transparent;
        }
        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(94, 53, 177, 0.4);
        }
        .hero {
            background: linear-gradient(135deg, rgba(94, 53, 177, 0.9), rgba(106, 90, 205, 0.9)), url('https://images.unsplash.com/photo-1520250497591-112f2f40a3f4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            padding: 150px 5% 100px;
            text-align: center;
        }
        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            animation: fadeInDown 1s;
        }
        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 2rem;
            opacity: 0.9;
        }
        .search-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 900px;
            margin: 2rem auto;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        .search-input {
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }
        .search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(94, 53, 177, 0.2);
        }
        .categories {
            padding: 5rem 5%;
            max-width: 1400px;
            margin: 0 auto;
            background-color: var(--light);
        }
        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }
        .section-title h2 {
            font-size: 2.5rem;
            color: var(--dark);
            margin-bottom: 1rem;
        }
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }
        .category-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            text-decoration: none;
            color: inherit;
            cursor: pointer;
        }
        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(94, 53, 177, 0.2);
        }
        .category-icon {
            font-size: 3rem;
            padding: 2rem;
            text-align: center;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        .category-info {
            padding: 1.5rem;
        }
        .category-info h3 {
            font-size: 1.3rem;
            margin-bottom: 0.5rem;
        }
        .featured {
            padding: 5rem 5%;
            max-width: 1400px;
            margin: 0 auto;
        }
        .listings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
        }
        .listing-card {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .listing-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(94, 53, 177, 0.2);
        }
        .listing-img {
            height: 200px;
            background-size: cover;
            background-position: center;
            position: relative;
        }
        .listing-price {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--accent);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            font-weight: bold;
        }
        .listing-info {
            padding: 1.5rem;
        }
        .listing-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--dark);
        }
        .listing-location {
            color: var(--gray);
            margin-bottom: 1rem;
        }
        .listing-features {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #eee;
        }
        .how-it-works {
            padding: 5rem 5%;
            background-color: var(--light);
        }
        .steps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 3rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        .step {
            text-align: center;
        }
        .step-number {
            width: 60px;
            height: 60px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0 auto 1.5rem;
        }
        .step h3 {
            margin-bottom: 1rem;
            color: var(--dark);
        }
        footer {
            background: var(--dark);
            color: white;
            padding: 3rem 5% 1rem;
        }
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            max-width: 1400px;
            margin: 0 auto 2rem;
        }
        .footer-links h4 {
            margin-bottom: 1rem;
            color: var(--accent);
        }
        .footer-links ul {
            list-style: none;
        }
        .footer-links ul li {
            margin-bottom: 0.5rem;
        }
        .footer-links a {
            color: #ccc;
            text-decoration: none;
            transition: color 0.3s;
        }
        .footer-links a:hover {
            color: white;
        }
        .copyright {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid rgba(255,255,255,0.1);
        }
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @media (max-width: 768px) {
            .nav-links {
                display: none;
            }
            .hero h1 {
                font-size: 2rem;
            }
            .search-box {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <a href="index.html" class="logo">
                <i class="fas fa-cube"></i>
                <span>RentHub</span>
            </a>
            <div class="nav-links">
                <a href="#categories">Categorías</a>
                <a href="#how-it-works">Cómo Funciona</a>
                <a href="#listings">Productos</a>
                <a href="dashboard.html">Mi Cuenta</a>
            </div>
            <div class="nav-buttons" id="authButtons"></div>
        </nav>
    </header>

    <section class="hero">
        <h1>Alquila lo que necesitas, cuando lo necesitas</h1>
        <p>Desde herramientas profesionales hasta equipos deportivos. Miles de productos disponibles en tu ciudad.</p>
        <div class="search-box">
            <input type="text" id="searchInput" class="search-input" placeholder="¿Qué buscas?" maxlength="100">
            <input type="text" id="locationInput" class="search-input" placeholder="Ciudad" maxlength="50">
            <select id="categorySelect" class="search-input">
                <option value="">Todas las categorías</option>
                <option value="herramientas">Herramientas</option>
                <option value="electronica">Electrónica</option>
                <option value="deportes">Deportes</option>
                <option value="vehiculos">Vehículos</option>
                <option value="eventos">Eventos</option>
            </select>
            <select id="durationSelect" class="search-input">
                <option value="">Duración</option>
                <option value="hora">Por hora</option>
                <option value="dia">Por día</option>
                <option value="semana">Por semana</option>
                <option value="mes">Por mes</option>
            </select>
            <input type="number" id="maxPriceInput" class="search-input" placeholder="Precio máx (€)" min="0" max="10000">
            <button class="btn btn-primary" onclick="searchListings()">
                <i class="fas fa-search"></i> Buscar
            </button>
        </div>
    </section>

    <section class="categories" id="categories">
        <div class="section-title">
            <h2>Explora por Categorías</h2>
            <p>Encuentra exactamente lo que necesitas</p>
        </div>
        <div class="categories-grid">
            <a href="listings.html?category=herramientas" class="category-card">
                <div class="category-icon"><i class="fas fa-tools"></i></div>
                <div class="category-info">
                    <h3>Herramientas</h3>
                    <p>Equipos profesionales para bricolaje y construcción</p>
                </div>
            </a>
            <a href="listings.html?category=electronica" class="category-card">
                <div class="category-icon"><i class="fas fa-camera"></i></div>
                <div class="category-info">
                    <h3>Electrónica</h3>
                    <p>Cámaras, drones, equipos de sonido y más</p>
                </div>
            </a>
            <a href="listings.html?category=deportes" class="category-card">
                <div class="category-icon"><i class="fas fa-bicycle"></i></div>
                <div class="category-info">
                    <h3>Deportes</h3>
                    <p>Bicicletas, esquís, kayaks y equipamiento</p>
                </div>
            </a>
            <a href="listings.html?category=vehiculos" class="category-card">
                <div class="category-icon"><i class="fas fa-car"></i></div>
                <div class="category-info">
                    <h3>Vehículos</h3>
                    <p>Coches, motos, furgonetas y más</p>
                </div>
            </a>
            <a href="listings.html?category=eventos" class="category-card">
                <div class="category-icon"><i class="fas fa-glass-cheers"></i></div>
                <div class="category-info">
                    <h3>Eventos</h3>
                    <p>Equipos para bodas, fiestas y celebraciones</p>
                </div>
            </a>
            <a href="listings.html?category=jardin" class="category-card">
                <div class="category-icon"><i class="fas fa-leaf"></i></div>
                <div class="category-info">
                    <h3>Jardín</h3>
                    <p>Cortacéspedes, desbrozadoras y más</p>
                </div>
            </a>
        </div>
    </section>

    <section class="featured" id="listings">
        <div class="section-title">
            <h2>Productos Destacados</h2>
            <p>Los más populares de tu zona</p>
        </div>
        <div class="listings-grid" id="featuredListings"></div>
    </section>

    <section class="how-it-works" id="how-it-works">
        <div class="section-title">
            <h2>¿Cómo Funciona?</h2>
            <p>Tan fácil como 1, 2, 3</p>
        </div>
        <div class="steps-grid">
            <div class="step">
                <div class="step-number">1</div>
                <h3>Busca</h3>
                <p>Encuentra el producto perfecto entre miles de opciones disponibles en tu ciudad</p>
            </div>
            <div class="step">
                <div class="step-number">2</div>
                <h3>Reserva</h3>
                <p>Reserva online de forma segura. Pago protegido y verificado</p>
            </div>
            <div class="step">
                <div class="step-number">3</div>
                <h3>Disfruta</h3>
                <p>Recoge el producto y úsalo. Devuélvelo cuando termines</p>
            </div>
        </div>
    </section>

    <footer>
        <div class="footer-content">
            <div class="footer-links">
                <h4>RentHub</h4>
                <p>La plataforma líder de alquiler en España. Conectando personas con lo que necesitan.</p>
            </div>
            <div class="footer-links">
                <h4>Enlaces</h4>
                <ul>
                    <li><a href="#categories">Categorías</a></li>
                    <li><a href="#how-it-works">Cómo Funciona</a></li>
                    <li><a href="#listings">Productos</a></li>
                    <li><a href="dashboard.html">Mi Cuenta</a></li>
                </ul>
            </div>
            <div class="footer-links">
                <h4>Legal</h4>
                <ul>
                    <li><a href="#">Términos y Condiciones</a></li>
                    <li><a href="#">Política de Privacidad</a></li>
                    <li><a href="#">Política de Cookies</a></li>
                    <li><a href="#">Aviso Legal</a></li>
                </ul>
            </div>
            <div class="footer-links">
                <h4>Contacto</h4>
                <ul>
                    <li><i class="fas fa-envelope"></i> info@renthub.es</li>
                    <li><i class="fas fa-phone"></i> +34 900 123 456</li>
                    <li><i class="fas fa-map-marker-alt"></i> Madrid, España</li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            <p>&copy; 2024 RentHub. Todos los derechos reservados.</p>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script>
        const SecurityUtils = {
            sanitizeText(text) {
                if (!text) return '';
                const div = document.createElement('div');
                div.textContent = String(text);
                return div.innerHTML;
            },
            isValidURL(url) {
                try {
                    const urlObj = new URL(url);
                    return urlObj.protocol === 'https:' && (urlObj.hostname.includes('unsplash.com') || urlObj.hostname.includes('cloudinary.com') || urlObj.hostname.includes('firebasestorage.googleapis.com'));
                } catch {
                    return false;
                }
            },
            sanitizeURL(url) {
                return this.isValidURL(url) ? url : 'https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80';
            },
            validateSearchInput(input, maxLength = 100) {
                if (!input) return '';
                return String(input).trim().slice(0, maxLength);
            },
            validateNumber(num, min = 0, max = 10000) {
                const parsed = parseFloat(num);
                if (isNaN(parsed)) return null;
                return Math.max(min, Math.min(max, parsed));
            },
            rateLimiter: {
                requests: {},
                isAllowed(key, maxRequests = 10, timeWindow = 60000) {
                    const now = Date.now();
                    if (!this.requests[key]) this.requests[key] = [];
                    this.requests[key] = this.requests[key].filter(time => now - time < timeWindow);
                    if (this.requests[key].length >= maxRequests) return false;
                    this.requests[key].push(now);
                    return true;
                }
            }
        };

        const firebaseConfig = {
            apiKey: "AIzaSyDA223bKA90MX_QpWuF1ARgWKldjXuiNo4",
            authDomain: "renthub-2030.firebaseapp.com",
            projectId: "renthub-2030",
            storageBucket: "renthub-2030.firebasestorage.app",
            messagingSenderId: "23301901800",
            appId: "1:23301901800:web:2679c834aac406c72d685d"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        auth.onAuthStateChanged((user) => {
            updateAuthButtons(user);
            loadFeaturedListings();
        });

        function updateAuthButtons(user) {
            const authButtons = document.getElementById('authButtons');
            authButtons.innerHTML = '';
            if (user) {
                const dashboardBtn = document.createElement('a');
                dashboardBtn.href = 'dashboard.html';
                dashboardBtn.className = 'btn btn-outline';
                dashboardBtn.innerHTML = '<i class="fas fa-user-circle"></i> Mi Panel';
                const logoutBtn = document.createElement('button');
                logoutBtn.className = 'btn btn-primary';
                logoutBtn.innerHTML = '<i class="fas fa-sign-out-alt"></i> Cerrar Sesión';
                logoutBtn.onclick = logout;
                authButtons.appendChild(dashboardBtn);
                authButtons.appendChild(logoutBtn);
            } else {
                const loginBtn = document.createElement('a');
                loginBtn.href = 'auth.html';
                loginBtn.className = 'btn btn-outline';
                loginBtn.innerHTML = '<i class="fas fa-sign-in-alt"></i> Iniciar Sesión';
                const registerBtn = document.createElement('a');
                registerBtn.href = 'auth.html';
                registerBtn.className = 'btn btn-primary';
                registerBtn.innerHTML = '<i class="fas fa-user-plus"></i> Registrarse';
                registerBtn.onclick = switchToRegister;
                authButtons.appendChild(loginBtn);
                authButtons.appendChild(registerBtn);
            }
        }

        function logout() {
            auth.signOut().then(() => window.location.reload()).catch((error) => console.error('Logout error'));
        }

        function switchToRegister() {
            try {
                sessionStorage.setItem('authTab', 'register');
            } catch (e) {
                console.error('Storage error');
            }
        }

        async function loadFeaturedListings() {
            if (!SecurityUtils.rateLimiter.isAllowed('loadListings', 5, 10000)) {
                console.warn('Too many requests');
                return;
            }
            try {
                const listingsRef = db.collection('listings');
                const snapshot = await listingsRef.where('featured', '==', true).limit(6).get();
                const listingsGrid = document.getElementById('featuredListings');
                listingsGrid.innerHTML = '';
                if (snapshot.empty) {
                    displaySampleListings();
                } else {
                    snapshot.forEach(doc => {
                        const listing = doc.data();
                        const card = createSecureListingCard(doc.id, listing);
                        listingsGrid.appendChild(card);
                    });
                }
            } catch (error) {
                console.error('Load error');
                displaySampleListings();
            }
        }

        function createSecureListingCard(id, listing) {
            const card = document.createElement('div');
            card.className = 'listing-card';
            const imgDiv = document.createElement('div');
            imgDiv.className = 'listing-img';
            const imageUrl = SecurityUtils.sanitizeURL(listing.images?.[0] || '');
            imgDiv.style.backgroundImage = `url('${imageUrl}')`;
            const priceSpan = document.createElement('span');
            priceSpan.className = 'listing-price';
            const price = SecurityUtils.validateNumber(listing.price, 0, 100000);
            priceSpan.textContent = `${price || '0'}€/${SecurityUtils.sanitizeText(listing.priceType || 'día')}`;
            imgDiv.appendChild(priceSpan);
            const infoDiv = document.createElement('div');
            infoDiv.className = 'listing-info';
            const title = document.createElement('h3');
            title.className = 'listing-title';
            title.textContent = SecurityUtils.sanitizeText(listing.title || 'Sin título');
            const location = document.createElement('div');
            location.className = 'listing-location';
            const locationIcon = document.createElement('i');
            locationIcon.className = 'fas fa-map-marker-alt';
            location.appendChild(locationIcon);
            location.appendChild(document.createTextNode(' ' + SecurityUtils.sanitizeText(listing.location || 'España')));
            const features = document.createElement('div');
            features.className = 'listing-features';
            const categorySpan = document.createElement('span');
            categorySpan.textContent = SecurityUtils.sanitizeText(listing.category || 'General');
            const viewBtn = document.createElement('button');
            viewBtn.className = 'btn btn-primary';
            viewBtn.textContent = 'Ver Detalles';
            viewBtn.onclick = () => viewListing(SecurityUtils.sanitizeText(id));
            features.appendChild(categorySpan);
            features.appendChild(viewBtn);
            infoDiv.appendChild(title);
            infoDiv.appendChild(location);
            infoDiv.appendChild(features);
            card.appendChild(imgDiv);
            card.appendChild(infoDiv);
            return card;
        }

        function displaySampleListings() {
            const sampleListings = [
                {id: '1', title: 'Taladro Percutor Profesional', location: 'Madrid', price: 15, priceType: 'día', images: ['https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'], category: 'Herramientas'},
                {id: '2', title: 'Cámara DSLR Canon EOS', location: 'Barcelona', price: 40, priceType: 'día', images: ['https://images.unsplash.com/photo-1516035069371-29a1b244cc32?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'], category: 'Electrónica'},
                {id: '3', title: 'Bicicleta de Montaña', location: 'Valencia', price: 12, priceType: 'día', images: ['https://images.unsplash.com/photo-1532298229144-0ec0c57515c7?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'], category: 'Deportes'}
            ];
            const listingsGrid = document.getElementById('featuredListings');
            listingsGrid.innerHTML = '';
            sampleListings.forEach(listing => {
                const card = createSecureListingCard(listing.id, listing);
                listingsGrid.appendChild(card);
            });
        }

        function searchListings() {
            const query = SecurityUtils.validateSearchInput(document.getElementById('searchInput').value, 100);
            const location = SecurityUtils.validateSearchInput(document.getElementById('locationInput').value, 50);
            const category = document.getElementById('categorySelect').value;
            const duration = document.getElementById('durationSelect').value;
            const maxPriceInput = document.getElementById('maxPriceInput').value;
            const maxPrice = SecurityUtils.validateNumber(maxPriceInput, 0, 10000);
            const params = [];
            if (query) params.push(`q=${encodeURIComponent(query)}`);
            if (location) params.push(`location=${encodeURIComponent(location)}`);
            if (category) params.push(`category=${encodeURIComponent(category)}`);
            if (duration) params.push(`duration=${encodeURIComponent(duration)}`);
            if (maxPrice !== null) params.push(`maxPrice=${maxPrice}`);
            window.location.href = 'listings.html?' + params.join('&');
        }

        function viewListing(id) {
            if (!id) return;
            window.location.href = `listing-detail.html?id=${encodeURIComponent(id)}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            console.log('✅ RentHub Secure - Ready');
            loadFeaturedListings();
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') searchListings();
                });
            }
        });
    </script>
</body>
</html>
